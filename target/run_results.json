{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-11-18T07:20:12.737124Z", "invocation_id": "013b1c56-3618-49a2-a725-c15be00979e1", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:20:04.210753Z", "completed_at": "2024-11-18T07:20:04.228224Z"}, {"name": "execute", "started_at": "2024-11-18T07:20:04.229794Z", "completed_at": "2024-11-18T07:20:08.104969Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 4.152873754501343, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01b872d8-0000-bf90-0000-71f100027192"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.deel_project.stg_globepay_chargeback_report", "compiled": true, "compiled_code": "\n\nSELECT \n    external_ref,\n    status,\n    source,\n    chargeback\nFROM DEEL_PROJECT_DB.raw.raw_globepay_chargeback_report\n\n\nWHERE external_ref NOT IN (SELECT external_ref FROM DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report)\n", "relation_name": "DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:20:04.192542Z", "completed_at": "2024-11-18T07:20:04.238182Z"}, {"name": "execute", "started_at": "2024-11-18T07:20:04.257890Z", "completed_at": "2024-11-18T07:20:08.166364Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.225687265396118, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01b872d8-0000-bf74-0000-71f10002626e"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.deel_project.stg_globepay_acceptance_report", "compiled": true, "compiled_code": "\n\nSELECT\n    external_ref,\n    status,\n    source,\n    ref,\n    date_time,\n    state,\n    cvv_provided,\n    amount,\n    country,\n    currency,\n    rates\nFROM DEEL_PROJECT_DB.raw.raw_globepay_acceptance_report\n\n\n    WHERE external_ref NOT IN (SELECT external_ref FROM DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report)\n", "relation_name": "DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:20:08.455955Z", "completed_at": "2024-11-18T07:20:08.517473Z"}, {"name": "execute", "started_at": "2024-11-18T07:20:08.524826Z", "completed_at": "2024-11-18T07:20:10.552464Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.3769888877868652, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b872d8-0000-bf74-0000-71f100026272"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.deel_project.int_acceptance_report_with_chargebacks", "compiled": true, "compiled_code": "-- depends_on: DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report\n-- depends_on: DEEL_PROJECT_DB.RAW_seeds.countries\n-- depends_on: DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report\n\n\n\nWITH base_data AS (\n    SELECT\n        EXTERNAL_REF,\n        STATUS,\n        SOURCE,\n        REF,\n        DATE_TIME,\n        STATE,\n        CVV_PROVIDED,\n        AMOUNT,\n        COUNTRY,\n        CURRENCY,\n        PARSE_JSON(RATES) AS rates_json\n    FROM DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report\n),\nparsed_rates AS (\n    SELECT\n        EXTERNAL_REF,\n        STATUS,\n        SOURCE,\n        REF,\n        DATE_TIME,\n        STATE,\n        CVV_PROVIDED,\n        AMOUNT,\n        COUNTRY,\n        CURRENCY,\n        rates_json:USD::FLOAT AS rate_usd,\n  rates_json:EUR::FLOAT AS rate_eur,\n  rates_json:CAD::FLOAT AS rate_cad,\n  rates_json:GBP::FLOAT AS rate_gbp,\n  rates_json:MXN::FLOAT AS rate_mxn,\n  rates_json:SGD::FLOAT AS rate_sgd,\n  rates_json:AUD::FLOAT AS rate_aud\n    FROM base_data\n),\nenriched_data AS (\n    SELECT\n        parsed_rates.*,\n        countries.name AS country_name\n    FROM parsed_rates\n    LEFT JOIN DEEL_PROJECT_DB.RAW_seeds.countries AS countries\n    ON parsed_rates.country = countries.abbreviation\n),\nfinal_data AS (\n    SELECT\n        a.external_ref,\n        a.status,\n        a.source,\n        a.ref,\n        a.date_time AS timestamp,\n        a.date_time::date AS date,\n        a.state,\n        a.cvv_provided,\n        a.amount,\n        a.country,\n        a.country_name,\n        a.currency,\n        a.rate_usd,\n        a.rate_eur,\n        a.rate_cad,\n        a.rate_gbp,\n        a.rate_mxn,\n        a.rate_sgd,\n        a.rate_aud,\n        c.chargeback\n    FROM enriched_data AS a\n    LEFT JOIN DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report AS c\n    ON a.external_ref = c.external_ref\n)\nSELECT *\nFROM final_data", "relation_name": "DEEL_PROJECT_DB.RAW_intermediate.int_acceptance_report_with_chargebacks"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:20:10.847794Z", "completed_at": "2024-11-18T07:20:10.898342Z"}, {"name": "execute", "started_at": "2024-11-18T07:20:10.902299Z", "completed_at": "2024-11-18T07:20:12.459619Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.8495712280273438, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b872d8-0000-bf90-0000-71f10002719e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.deel_project.fct_globepay_transactions", "compiled": true, "compiled_code": "\n\nSELECT\n    a.external_ref,\n    a.status,\n    a.source,\n    a.ref,\n    a.timestamp,\n    a.date,\n    a.state,\n    a.cvv_provided,\n    a.amount,\n    a.country,\n    a.country_name,\n    a.currency,\n    a.rate_usd,\n    a.rate_eur,\n    a.rate_cad,\n    a.rate_gbp,\n    a.rate_mxn,\n    a.rate_sgd,\n    a.rate_aud,\n    a.chargeback,\n    CASE\n        WHEN a.chargeback IS NULL THEN TRUE\n        ELSE FALSE\n    END AS is_missing_chargeback\nFROM DEEL_PROJECT_DB.RAW_intermediate.int_acceptance_report_with_chargebacks AS a", "relation_name": "DEEL_PROJECT_DB.RAW_analytics.fct_globepay_transactions"}], "elapsed_time": 12.76954460144043, "args": {"use_colors_file": true, "empty": false, "vars": {}, "log_path": "/mnt/c/Users/pwor_/OneDrive/Documentos/GitHub/deel-analytics-engineering/logs", "exclude": [], "printer_width": 80, "profiles_dir": "/home/prodrigues/.dbt", "log_file_max_bytes": 10485760, "populate_cache": true, "project_dir": "/mnt/c/Users/pwor_/OneDrive/Documentos/GitHub/deel-analytics-engineering", "show_resource_report": false, "log_format_file": "debug", "log_level_file": "debug", "strict_mode": false, "favor_state": false, "indirect_selection": "eager", "partial_parse": true, "introspect": true, "version_check": true, "select": [], "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "which": "run", "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "static_parser": true, "require_resource_names_without_spaces": false, "defer": false, "macro_debugging": false, "log_level": "info", "partial_parse_file_diff": true, "cache_selected_only": false, "enable_legacy_logger": false, "source_freshness_run_project_hooks": false, "quiet": false, "write_json": true, "print": true, "invocation_command": "dbt run", "send_anonymous_usage_stats": true}}