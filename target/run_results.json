{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-11-18T07:42:02.294894Z", "invocation_id": "35507e23-6052-4ff6-89d6-a17e4e63ce9c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:42:02.111751Z", "completed_at": "2024-11-18T07:42:02.113171Z"}, {"name": "execute", "started_at": "2024-11-18T07:42:02.116243Z", "completed_at": "2024-11-18T07:42:02.116266Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029294490814208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.deel_project.countries", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:42:02.092853Z", "completed_at": "2024-11-18T07:42:02.119371Z"}, {"name": "execute", "started_at": "2024-11-18T07:42:02.120590Z", "completed_at": "2024-11-18T07:42:02.120602Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.036802053451538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.deel_project.stg_globepay_acceptance_report", "compiled": true, "compiled_code": "\n\nSELECT\n    external_ref,\n    status,\n    source,\n    ref,\n    date_time,\n    state,\n    cvv_provided,\n    amount,\n    country,\n    currency,\n    rates\nFROM DEEL_PROJECT_DB.raw.raw_globepay_acceptance_report\n\n\n    WHERE external_ref NOT IN (SELECT external_ref FROM DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report)\n", "relation_name": "DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:42:02.107071Z", "completed_at": "2024-11-18T07:42:02.121253Z"}, {"name": "execute", "started_at": "2024-11-18T07:42:02.124122Z", "completed_at": "2024-11-18T07:42:02.124132Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03872489929199219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.deel_project.stg_globepay_chargeback_report", "compiled": true, "compiled_code": "\n\nSELECT \n    external_ref,\n    status,\n    source,\n    chargeback\nFROM DEEL_PROJECT_DB.raw.raw_globepay_chargeback_report\n\n\nWHERE external_ref NOT IN (SELECT external_ref FROM DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report)\n", "relation_name": "DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:42:02.163540Z", "completed_at": "2024-11-18T07:42:02.170763Z"}, {"name": "execute", "started_at": "2024-11-18T07:42:02.171921Z", "completed_at": "2024-11-18T07:42:02.171935Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03888678550720215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.deel_project.validate_amount_test", "compiled": true, "compiled_code": "SELECT *\nFROM DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report\nWHERE amount <= 0;", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:42:02.134472Z", "completed_at": "2024-11-18T07:42:02.172600Z"}, {"name": "execute", "started_at": "2024-11-18T07:42:02.176102Z", "completed_at": "2024-11-18T07:42:02.176114Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05081605911254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.deel_project.not_null_stg_globepay_acceptance_report_external_ref.0dc37e75be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect external_ref\nfrom DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report\nwhere external_ref is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:42:02.145579Z", "completed_at": "2024-11-18T07:42:02.172977Z"}, {"name": "execute", "started_at": "2024-11-18T07:42:02.177698Z", "completed_at": "2024-11-18T07:42:02.177708Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05137133598327637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.deel_project.unique_stg_globepay_acceptance_report_external_ref.ebb99a2ac3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    external_ref as unique_field,\n    count(*) as n_records\n\nfrom DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report\nwhere external_ref is not null\ngroup by external_ref\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:42:02.152404Z", "completed_at": "2024-11-18T07:42:02.173490Z"}, {"name": "execute", "started_at": "2024-11-18T07:42:02.178995Z", "completed_at": "2024-11-18T07:42:02.179005Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.051538705825805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.deel_project.validate_amount_stg_globepay_acceptance_report_amount.156752fecb", "compiled": true, "compiled_code": "\nSELECT *\nFROM DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report\nWHERE amount <= 0\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:42:02.187752Z", "completed_at": "2024-11-18T07:42:02.217211Z"}, {"name": "execute", "started_at": "2024-11-18T07:42:02.222162Z", "completed_at": "2024-11-18T07:42:02.222186Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04205513000488281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.deel_project.int_acceptance_report_with_chargebacks", "compiled": true, "compiled_code": "-- depends_on: DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report\n-- depends_on: DEEL_PROJECT_DB.RAW_seeds.countries\n-- depends_on: DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report\n\n\n\nWITH base_data AS (\n    SELECT\n        EXTERNAL_REF,\n        STATUS,\n        SOURCE,\n        REF,\n        DATE_TIME,\n        STATE,\n        CVV_PROVIDED,\n        AMOUNT,\n        COUNTRY,\n        CURRENCY,\n        PARSE_JSON(RATES) AS rates_json\n    FROM DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report\n),\nparsed_rates AS (\n    SELECT\n        EXTERNAL_REF,\n        STATUS,\n        SOURCE,\n        REF,\n        DATE_TIME,\n        STATE,\n        CVV_PROVIDED,\n        AMOUNT,\n        COUNTRY,\n        CURRENCY,\n        rates_json:USD::FLOAT AS rate_usd,\n  rates_json:EUR::FLOAT AS rate_eur,\n  rates_json:CAD::FLOAT AS rate_cad,\n  rates_json:GBP::FLOAT AS rate_gbp,\n  rates_json:MXN::FLOAT AS rate_mxn,\n  rates_json:SGD::FLOAT AS rate_sgd,\n  rates_json:AUD::FLOAT AS rate_aud\n    FROM base_data\n),\nenriched_data AS (\n    SELECT\n        parsed_rates.*,\n        countries.name AS country_name\n    FROM parsed_rates\n    LEFT JOIN DEEL_PROJECT_DB.RAW_seeds.countries AS countries\n    ON parsed_rates.country = countries.abbreviation\n),\nfinal_data AS (\n    SELECT\n        a.external_ref,\n        a.status,\n        a.source,\n        a.ref,\n        a.date_time AS timestamp,\n        a.date_time::date AS date,\n        a.state,\n        a.cvv_provided,\n        a.amount,\n        a.country,\n        a.country_name,\n        a.currency,\n        a.rate_usd,\n        a.rate_eur,\n        a.rate_cad,\n        a.rate_gbp,\n        a.rate_mxn,\n        a.rate_sgd,\n        a.rate_aud,\n        c.chargeback\n    FROM enriched_data AS a\n    LEFT JOIN DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report AS c\n    ON a.external_ref = c.external_ref\n)\nSELECT *\nFROM final_data", "relation_name": "DEEL_PROJECT_DB.RAW_intermediate.int_acceptance_report_with_chargebacks"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:42:02.199563Z", "completed_at": "2024-11-18T07:42:02.223484Z"}, {"name": "execute", "started_at": "2024-11-18T07:42:02.229295Z", "completed_at": "2024-11-18T07:42:02.229315Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04379439353942871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.deel_project.not_null_stg_globepay_chargeback_report_external_ref.52163c329a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect external_ref\nfrom DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report\nwhere external_ref is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:42:02.203636Z", "completed_at": "2024-11-18T07:42:02.230239Z"}, {"name": "execute", "started_at": "2024-11-18T07:42:02.235366Z", "completed_at": "2024-11-18T07:42:02.235381Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04877281188964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.deel_project.unique_stg_globepay_chargeback_report_external_ref.cff7fc84cf", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    external_ref as unique_field,\n    count(*) as n_records\n\nfrom DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report\nwhere external_ref is not null\ngroup by external_ref\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T07:42:02.244324Z", "completed_at": "2024-11-18T07:42:02.270205Z"}, {"name": "execute", "started_at": "2024-11-18T07:42:02.272666Z", "completed_at": "2024-11-18T07:42:02.272695Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04121518135070801, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.deel_project.fct_globepay_transactions", "compiled": true, "compiled_code": "\n\nSELECT\n    a.external_ref,\n    a.status,\n    a.source,\n    a.ref,\n    a.timestamp,\n    a.date,\n    a.state,\n    a.cvv_provided,\n    a.amount,\n    a.country,\n    a.country_name,\n    a.currency,\n    a.rate_usd,\n    a.rate_eur,\n    a.rate_cad,\n    a.rate_gbp,\n    a.rate_mxn,\n    a.rate_sgd,\n    a.rate_aud,\n    a.chargeback,\n    CASE\n        WHEN a.chargeback IS NULL THEN TRUE\n        ELSE FALSE\n    END AS is_missing_chargeback\nFROM DEEL_PROJECT_DB.RAW_intermediate.int_acceptance_report_with_chargebacks AS a", "relation_name": "DEEL_PROJECT_DB.RAW_analytics.fct_globepay_transactions"}], "elapsed_time": 2.1800436973571777, "args": {"warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "favor_state": false, "static": false, "strict_mode": false, "log_level": "info", "require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": false, "partial_parse_file_diff": true, "exclude": [], "show_resource_report": false, "use_colors": true, "write_json": true, "compile": true, "populate_cache": true, "static_parser": true, "quiet": false, "source_freshness_run_project_hooks": false, "vars": {}, "log_file_max_bytes": 10485760, "log_path": "/mnt/c/Users/pwor_/OneDrive/Documentos/GitHub/deel-analytics-engineering/logs", "invocation_command": "dbt docs generate", "indirect_selection": "eager", "project_dir": "/mnt/c/Users/pwor_/OneDrive/Documentos/GitHub/deel-analytics-engineering", "version_check": true, "introspect": true, "partial_parse": true, "log_format": "default", "defer": false, "print": true, "log_format_file": "debug", "which": "generate", "use_colors_file": true, "cache_selected_only": false, "send_anonymous_usage_stats": true, "enable_legacy_logger": false, "printer_width": 80, "select": [], "empty_catalog": false, "macro_debugging": false, "profiles_dir": "/home/prodrigues/.dbt"}}