{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-11-18T06:43:02.173673Z", "invocation_id": "e4bb4af8-f4db-4ac8-9ec3-50af3b0c9750", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T06:42:54.985782Z", "completed_at": "2024-11-18T06:42:55.021917Z"}, {"name": "execute", "started_at": "2024-11-18T06:42:55.040418Z", "completed_at": "2024-11-18T06:42:58.383575Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.6593034267425537, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01b872b2-0000-bf74-0000-71f100023e2e"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.deel_project.stg_globepay_chargeback_report", "compiled": true, "compiled_code": "\n\nSELECT \n    external_ref,\n    status,\n    source,\n    chargeback\nFROM DEEL_PROJECT_DB.raw.raw_globepay_chargeback_report\n\n\nWHERE external_ref NOT IN (SELECT external_ref FROM DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report)\n", "relation_name": "DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T06:42:54.961855Z", "completed_at": "2024-11-18T06:42:55.010528Z"}, {"name": "execute", "started_at": "2024-11-18T06:42:55.016111Z", "completed_at": "2024-11-18T06:42:58.428268Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.707361936569214, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01b872b2-0000-bf74-0000-71f100023e32"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.deel_project.stg_globepay_acceptance_report", "compiled": true, "compiled_code": "\n\nSELECT\n    external_ref,\n    status,\n    source,\n    ref,\n    date_time,\n    state,\n    cvv_provided,\n    amount,\n    country,\n    currency,\n    rates\nFROM DEEL_PROJECT_DB.raw.raw_globepay_acceptance_report\n\n\n    WHERE external_ref NOT IN (SELECT external_ref FROM DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report)\n", "relation_name": "DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T06:42:58.685259Z", "completed_at": "2024-11-18T06:42:58.713873Z"}, {"name": "execute", "started_at": "2024-11-18T06:42:58.715712Z", "completed_at": "2024-11-18T06:43:00.229546Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.7819867134094238, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b872b2-0000-bf7c-0000-71f1000259ce"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.deel_project.int_acceptance_report_with_chargebacks", "compiled": true, "compiled_code": "-- depends_on: DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report\n-- depends_on: DEEL_PROJECT_DB.RAW_seeds.countries\n-- depends_on: DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report\n\n\n\nWITH base_data AS (\n    SELECT\n        EXTERNAL_REF,\n        STATUS,\n        SOURCE,\n        REF,\n        DATE_TIME,\n        STATE,\n        CVV_PROVIDED,\n        AMOUNT,\n        COUNTRY,\n        CURRENCY,\n        PARSE_JSON(RATES) AS rates_json\n    FROM DEEL_PROJECT_DB.RAW_staging.stg_globepay_acceptance_report\n),\nparsed_rates AS (\n    SELECT\n        EXTERNAL_REF,\n        STATUS,\n        SOURCE,\n        REF,\n        DATE_TIME,\n        STATE,\n        CVV_PROVIDED,\n        AMOUNT,\n        COUNTRY,\n        CURRENCY,\n        rates_json:USD::FLOAT AS rate_usd,\n  rates_json:EUR::FLOAT AS rate_eur,\n  rates_json:CAD::FLOAT AS rate_cad,\n  rates_json:GBP::FLOAT AS rate_gbp,\n  rates_json:MXN::FLOAT AS rate_mxn,\n  rates_json:SGD::FLOAT AS rate_sgd,\n  rates_json:AUD::FLOAT AS rate_aud\n    FROM base_data\n),\nenriched_data AS (\n    SELECT\n        parsed_rates.*,\n        countries.name AS country_name\n    FROM parsed_rates\n    LEFT JOIN DEEL_PROJECT_DB.RAW_seeds.countries AS countries\n    ON parsed_rates.country = countries.abbreviation\n),\nfinal_data AS (\n    SELECT\n        a.external_ref,\n        a.status,\n        a.source,\n        a.ref,\n        a.date_time AS timestamp,\n        a.date_time::date AS date,\n        a.state,\n        a.cvv_provided,\n        a.amount,\n        a.country,\n        a.country_name,\n        a.currency,\n        a.rate_usd,\n        a.rate_eur,\n        a.rate_cad,\n        a.rate_gbp,\n        a.rate_mxn,\n        a.rate_sgd,\n        a.rate_aud,\n        c.chargeback\n    FROM enriched_data AS a\n    LEFT JOIN DEEL_PROJECT_DB.RAW_staging.stg_globepay_chargeback_report AS c\n    ON a.external_ref = c.external_ref\n)\nSELECT *\nFROM final_data", "relation_name": "DEEL_PROJECT_DB.RAW_intermediate.int_acceptance_report_with_chargebacks"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-18T06:43:00.495783Z", "completed_at": "2024-11-18T06:43:00.529597Z"}, {"name": "execute", "started_at": "2024-11-18T06:43:00.531683Z", "completed_at": "2024-11-18T06:43:01.895626Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.6476624011993408, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b872b3-0000-bf74-0000-71f100023e42"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.deel_project.fct_globepay_transactions", "compiled": true, "compiled_code": "\n\nSELECT\n    a.external_ref,\n    a.status,\n    a.source,\n    a.ref,\n    a.timestamp,\n    a.date,\n    a.state,\n    a.cvv_provided,\n    a.amount,\n    a.country,\n    a.country_name,\n    a.currency,\n    a.rate_usd,\n    a.rate_eur,\n    a.rate_cad,\n    a.rate_gbp,\n    a.rate_mxn,\n    a.rate_sgd,\n    a.rate_aud,\n    a.chargeback,\n    CASE\n        WHEN a.chargeback IS NULL THEN TRUE\n        ELSE FALSE\n    END AS is_missing_chargeback\nFROM DEEL_PROJECT_DB.RAW_intermediate.int_acceptance_report_with_chargebacks AS a", "relation_name": "DEEL_PROJECT_DB.RAW.fct_globepay_transactions"}], "elapsed_time": 9.819203615188599, "args": {"partial_parse_file_diff": true, "which": "run", "cache_selected_only": false, "log_file_max_bytes": 10485760, "populate_cache": true, "partial_parse": true, "log_level_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "empty": false, "favor_state": false, "show_resource_report": false, "vars": {}, "strict_mode": false, "log_format_file": "debug", "use_colors_file": true, "require_explicit_package_overrides_for_builtin_materializations": true, "static_parser": true, "profiles_dir": "/home/prodrigues/.dbt", "use_colors": true, "invocation_command": "dbt run", "write_json": true, "exclude": [], "macro_debugging": false, "send_anonymous_usage_stats": true, "select": [], "log_level": "info", "quiet": false, "enable_legacy_logger": false, "print": true, "version_check": true, "project_dir": "/mnt/c/Users/pwor_/OneDrive/Documentos/GitHub/deel-analytics-engineering", "require_resource_names_without_spaces": false, "log_format": "default", "source_freshness_run_project_hooks": false, "introspect": true, "printer_width": 80, "log_path": "/mnt/c/Users/pwor_/OneDrive/Documentos/GitHub/deel-analytics-engineering/logs", "indirect_selection": "eager", "defer": false}}